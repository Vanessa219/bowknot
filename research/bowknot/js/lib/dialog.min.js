!function(t){t.fn.extend({dialog:{version:"0.0.1.7",author:"lly219@gmail.com"}});var e=(new Date).getTime(),i="dialog",o=function(){this._defaults={styleClass:{background:"dialog-background",panel:"dialog-panel",main:"dialog-main",footer:"dialog-footer",headerMiddle:"dialog-header-middle",headerBg:"dialog-header-bg",closeIcon:"icon-close",closeIconHover:"dialog-close-icon-hover",title:"dialog-title"}}};t.extend(o.prototype,{_attach:function(e,o){e.id||(this.uuid++,e.id="dp"+this.uuid);var a=this._newInst(t(e));a.settings=t.extend({},o||{}),t.data(e,i,a),this._init(e)},_newInst:function(t){var e=t[0].id.replace(/([^A-Za-z0-9_])/g,"\\\\$1");return{id:e}},_getInst:function(e){try{return t.data(e,i)}catch(o){throw"Missing instance data for this dialog"}},_destroyDialog:function(e){var o=t.dialog._getInst(e),a=o.id;t.removeData(e,i),t(e).prependTo("#"+a+"Wrap").unwrap(),t(e).removeAttr("style");var n=this._getDefaults(t.dialog._defaults,o.settings,"styleClass");t("."+n.background).remove(),t("#"+a+"Dialog").remove()},_init:function(e){var i=this._getInst(e),o=i.id,a=i.settings,n=t(window).height(),l=t(window).width(),s=this._getDefaults(t.dialog._defaults,a,"styleClass"),d=a.height?a.height:parseInt(.6*n),r=a.width?a.width:parseInt(.6*l);a.title=a.title?a.title:"",a.okText=a.okText?a.okText:"Ok",a.cancelText=a.cancelText?a.cancelText:"Cancel";var c="",g="<div class='fn-clear "+s.headerBg+"'><div class='"+s.title+"'>"+a.title+"</div><a href='javascript:void(0);' class='"+s.closeIcon+"'></a></div>";a.hideFooter||(c="<a href='javascript:void(0);'>"+a.okText+"</a><a href='javascript:void(0);'>"+a.cancelText+"</a>");var h="<div id='"+o+"Dialog' class='"+s.panel+"' style='width: "+r+"px; height: "+d+"px;' onselectstart='return false;'>"+g+"<div class='"+s.main+"'><div style='overflow: auto;height:"+(d-53)+"px'></div><div class='"+s.footer+"'>"+c+"</div></div>",u="";if(a.modal&&0===t("."+s.background).length){var v=n<document.documentElement.scrollHeight?document.documentElement.scrollHeight:n;u="<div style='height:"+v+"px;' class='"+s.background+"'></div>"}t("#"+o).wrap("<div id='"+o+"Wrap'></div>");var f=t(e).clone(!0);t(e).remove(),t("body").append(u+h),t(t("#"+o+"Dialog ."+s.main+" div").get(0)).append(f),t(f).show();var p="",w="",m=t("#"+o+"Dialog");a.position?(p=a.position.top,w=a.position.left):(p=parseInt((n-d)/2),w=parseInt((l-r)/2)),m.css({top:p+"px",left:w+"px"}),t("#"+o+"Dialog ."+s.closeIcon).bind("click",function(){t.dialog._close(o,a)});var _=t("#"+o+"Dialog ."+s.footer+" a");t(_.get(1)).bind("click",function(){t.dialog._close(o,a)}),t(_.get(0)).bind("click",function(){(void 0===a.ok||a.ok())&&t.dialog._close(o,a)}),this._bindMove(o,s.headerBg,d,r),t(window).keyup(function(e){27===e.keyCode&&t.dialog._close(o,a)})},_bindMove:function(e,i){t("#"+e+"Dialog ."+i).mousedown(function(i){var o=document;i||(i=window.event);var a=document.getElementById(e+"Dialog"),n=i.clientX-parseInt(a.style.left),l=i.clientY-parseInt(a.style.top);o.ondragstart="return false;",o.onselectstart="return false;",o.onselect="document.selection.empty();",this.setCapture?this.setCapture():window.captureEvents&&window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP),o.onmousemove=function(e){e||(e=window.event);var i=e.clientX-n,o=e.clientY-l;0>i&&(i=0),i>t(window).width()-t(a).width()&&(i=t(window).width()-t(a).width()),0>o&&(o=0),o>t(window).height()-t(a).height()&&(o=t(window).height()-t(a).height()),a.style.left=i+"px",a.style.top=o+"px"},o.onmouseup=function(){this.releaseCapture?this.releaseCapture():window.captureEvents&&window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP),o.onmousemove=null,o.onmouseup=null,o.ondragstart=null,o.onselectstart=null,o.onselect=null}})},_close:function(e,i){if("none"!==t("#"+e+"Dialog").css("display")&&(void 0===i.close||i.close())&&(t("#"+e+"Dialog").hide(),i.modal)){var o=this._getDefaults(t.dialog._defaults,i,"styleClass");t("."+o.background).hide()}},_closeDialog:function(e){var i=this._getInst(e),o=i.id,a=i.settings;t.dialog._close(o,a)},_openDialog:function(e){var i=this._getInst(e),o=i.id,a=i.settings;if(t("#"+o+"Dialog").show(),a.modal){var n=this._getDefaults(t.dialog._defaults,a,"styleClass");t("."+n.background).show()}},_updateDialog:function(e,i){var o=this._getInst(e),a=o.id,n=o.settings,l=this._getDefaults(t.dialog._defaults,n,"styleClass");t.extend(n,i);var s=t("#"+a+"Dialog");i.position&&s.css({top:i.position.top,left:i.position.left}),i.width&&(s.width(i.width+26),s.find("."+l.main+" div")[0].style.width=i.width+"px",s.find("."+l.headerBg).width(i.width+18)),i.height&&(s.find("."+l.main+" div")[0].style.height=i.height+"px"),i.title&&s.find("."+l.title).html(i.title),void 0!==i.modal&&(i.modal?t("."+l.background).show():t("."+l.background).hide()),void 0!==i.hideFooter&&(i.hideFooter?s.find("."+l.footer).hide():s.find("."+l.footer).show())},_getDefaults:function(t,e,i){if("styleClass"===i){if("default"===e.theme||void 0===e.theme)return t.styleClass;e.styleClass={};for(var o in t[i])e.styleClass[o]=e.theme+"-"+t.styleClass[o]}else{if("height"===i||"width"===i)return null===e[i]||void 0===e[i]?"auto":e[i]+"px";if(null===e[i]||void 0===e[i])return t[i]}return e[i]}}),t.fn.dialog=function(e){var i=Array.prototype.slice.call(arguments);return"string"==typeof e?(i.shift(),t.dialog["_"+e+"Dialog"].apply(t.dialog,[this[0]].concat(i))):this.each(function(){t.dialog._attach(this,e)})},t.dialog=new o,window["DP_jQuery_"+e]=t}(jQuery);